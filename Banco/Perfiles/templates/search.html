{% extends 'base.html' %}
{% load static %}

{% block navblock %}
<li class="nav-item">
  <a class="nav-link" href="/">Inicio</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="/cuenta">Cuenta</a>
</li>
<li class="nav-item dropdown">
  <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
    Actividad
  </a>
  <div class="dropdown-menu" aria-labelledby="navbarDropdown">
    <a class="dropdown-item" href="/actividad/transacciones">Transacciones</a>
    <a class="dropdown-item" href="/actividad/transferencias">Transferencias</a>
  </div>
</li>
<li class="nav-item">
    <a class="nav-link" href="/about-us">Sobre Nosotros</a>
</li>
<li class="nav-item">
    <a class="nav-link" href="/info-personal">Informaci√≥n Personal</a>
</li>
{% endblock %}

{% block mainblock %}

<center>
    {% for i in all_users %}
    {% if search in i.user__email or search in i.user__first_name or search in i.user__last_name %}
    {% if not i.cvu == None %}
    <div class="row" style="margin: 20px;">
        <div class="col-sm-12">
          <div class="card">
            <div class="card-body">
              <h5 class="card-title">{{i.user__first_name}} {{i.user__last_name}}</h5>
              <p class="card-text"><a href="mailto:{{i.user__email}}">{{i.user__email}}</a></p>
              <p class="card-text">CVU: <strong id="{{i.cvu}}">{{i.cvu}}</strong></p>
              <button class="btn btn-dark" id="{{i.cvu}}-btn" onclick="copyCvu{{i.cvu}}('{{i.cvu}}')">Copiar CVU</button>
            </div>
          </div>
        </div>
      </div>

      <script>
        function copyCvu{{i.cvu}}(elementId) {
  
          var aux = document.createElement("input");

          var btn = document.getElementById("{{i.cvu}}-btn");

          aux.setAttribute("value", document.getElementById(elementId).innerHTML);

          document.body.appendChild(aux);

          aux.select();

          document.execCommand("copy");

          document.body.removeChild(aux);

          btn.className = "btn btn-success";

          btn.innerHTML = "Copiado &#10004;";

          setTimeout(() => { 
            btn.className = "btn btn-dark";
            btn.innerHTML = "Copiar CVU";
           }, 4000)

        }
      </script>

    {% endif %}
    {% endif %}
    {% endfor %}

    {% if all_users.has_other_pages %}

    <nav aria-label="Page navigation example">
      <ul class="pagination">
        {% if all_users.has_previous %}
          <li class="page-item"><a class="page-link" href="?page={{ all_users.previous_page_number }}">&laquo;</a></li>
        {% else %}
          <li class="page-item disabled"><a class="page-link" href="#" tabindex="-1"><span>&laquo;</span></a></li>
        {% endif %}
        {% for i in all_users.paginator.page_range %}
          {% if all_users.number == i %}
            <li class="page-item active"><a class="page-link" href="#"><span>{{ i }} <span class="sr-only">(current)</span></span></a></li>
          {% else %}
            <li class="page-item"><a class="page-link" href="?page={{ i }}">{{ i }}</a></li>
          {% endif %}
        {% endfor %}
        {% if all_users.has_next %}
          <li class="page-item"><a class="page-link" href="?page={{ all_users.next_page_number }}">&raquo;</a></li>
        {% else %}
          <li class="page-item disabled"><a class="page-link" href="#"><span>&raquo;</span></a></li>
        {% endif %}
      </ul>
    </nav>
    {% endif %}
    
</center>

{% endblock mainblock %}